<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Carl Boettiger" />
<meta name="author" content="Scott Chamberlain" />
<meta name="author" content="Rutger Vos" />
<meta name="author" content="Hilmar Lapp" />


<title>Extending NeXML: an example based on simmap</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Extending NeXML: an example based on simmap</h1>
<h4 class="author"><em>Carl Boettiger</em></h4>
<h4 class="author"><em>Scott Chamberlain</em></h4>
<h4 class="author"><em>Rutger Vos</em></h4>
<h4 class="author"><em>Hilmar Lapp</em></h4>



<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Extending NeXML to simmap}
-->
<div id="extending-the-nexml-standard-through-metadata-annotation." class="section level2">
<h2>Extending the NeXML standard through metadata annotation.</h2>
<p>Here we illustrate this process using the example of stochastic character mapping <span class="citation">(Huelsenbeck, Nielsen, and Bollback 2003)</span>. A stochastic character map is simply an annotation of the branches on a phylogeny, assigning each section of each branch to a particular “state” (typically of a morphological characteristic).</p>
<p><span class="citation">J. Bollback (2006)</span> provides a widely used stand-alone software implementation of this method in the software <code>simmap</code>, which modified the standard Newick tree format to express this additional information. This can break compatibility with other software, and creates a format that cannot be interpreted without additional information describing this convention. By contrast, the NeXML extension is not only backwards compatible but contains a precise and machine-readable description of what it is encoding.</p>
<p>In this example, we illustrate how the additional information required to define a stochastic character mapping (a <code>simmap</code> mapping) in NeXML.</p>
<p><span class="citation">Revell (2012)</span> describes the <code>phytools</code> package for R, which includes utilities for reading, manipulating, and writing <code>simmap</code> files in R. In this example, we also show how to define <code>RNeXML</code> functions that map the R representation used by Revell (an extension of the <code>ape</code> class) into the NeXML extension we have defined by using <code>RNeXML</code> functions.</p>
<p>Since a stochastic character map simply assigns different states to parts of a branch (or edge) on the phylogenetic tree, we can create a NeXML representation by annotating the <code>edge</code> elements with appropriate <code>meta</code> elements. These elements need to describe the character state being assigned and the duration (in terms of branch-length) that the edge spends in that state (Stochastic character maps are specific to time-calibrated or ultrametric trees).</p>
<p>NeXML already defines the <code>characters</code> element to handle discrete character traits (<code>nex:char</code>) and the states they can assume (<code>nex:state</code>). We will thus reuse the <code>characters</code> element for this purpose, referring to both the character trait and the states by the ids assigned to them in that element. (NeXML’s convention of referring to everything by id permits a single canonical definition of each term, making it clear where additional annotation belongs). For each edge, we need to indicate:</p>
<ul>
<li>That our annotation contains a stochastic character mapping reconstruction</li>
<li>Since many reconstructions are possible for a single edge, we give each reconstruction an id</li>
<li>We indicate for which character trait we are defining the reconstruction</li>
<li>We then indicate which states the character assumes on that edge. For each state realized on the edge, that involves stating:
<ul>
<li>the state assignment</li>
<li>the duration (length of time) for which the edge spends in the given state</li>
<li>the order in which the state changes happen (Though we could just assume state transitions are listed chronologically, NeXML suggests making all data explicit, rather than relying on the structure of the data file to convey information).</li>
</ul></li>
</ul>
<p>Thus the annotation for an edge that switches from state <code>s2</code> to state <code>s1</code> of character <code>cr1</code> would be constructed like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> m &lt;-<span class="st"> </span><span class="kw">meta</span>(<span class="st">&quot;simmap:reconstructions&quot;</span>, <span class="dt">children =</span> <span class="kw">c</span>(
        <span class="kw">meta</span>(<span class="st">&quot;simmap:reconstruction&quot;</span>, <span class="dt">children =</span> <span class="kw">c</span>(

          <span class="kw">meta</span>(<span class="st">&quot;simmap:char&quot;</span>, <span class="st">&quot;cr1&quot;</span>),
          <span class="kw">meta</span>(<span class="st">&quot;simmap:stateChange&quot;</span>, <span class="dt">children =</span> <span class="kw">c</span>(
            <span class="kw">meta</span>(<span class="st">&quot;simmap:order&quot;</span>, <span class="dv">1</span>),
            <span class="kw">meta</span>(<span class="st">&quot;simmap:length&quot;</span>, <span class="st">&quot;0.2030&quot;</span>),
            <span class="kw">meta</span>(<span class="st">&quot;simmap:state&quot;</span>, <span class="st">&quot;s2&quot;</span>))),
          
          <span class="kw">meta</span>(<span class="st">&quot;simmap:char&quot;</span>, <span class="st">&quot;cr1&quot;</span>),
          <span class="kw">meta</span>(<span class="st">&quot;simmap:stateChange&quot;</span>, <span class="dt">children =</span> <span class="kw">c</span>(
            <span class="kw">meta</span>(<span class="st">&quot;simmap:order&quot;</span>, <span class="dv">2</span>),
            <span class="kw">meta</span>(<span class="st">&quot;simmap:length&quot;</span>, <span class="st">&quot;0.0022&quot;</span>),
            <span class="kw">meta</span>(<span class="st">&quot;simmap:state&quot;</span>, <span class="st">&quot;s1&quot;</span>)))
          ))))</code></pre></div>
<p>Of course writing out such a definition manually becomes tedious quickly. Because these are just R commands, we can easily define a function that can loop over an assignment like this for each edge, extracting the appropriate order, length and state from an existing R object such as that provided in the <code>phytools</code> package.<br />
Likewise, it is straightforward to define a function that reads this data using the <code>RNeXML</code> utilities and converts it back to the <code>phytools</code> package. The full implementation of this mapping can be seen in the <code>simmap_to_nexml()</code> and the <code>nexml_to_simmap()</code> functions provided in the <code>RNeXML</code> package.</p>
<p>As the code indicates, the key step is simply to define the data in meta elements. In so doing, we have defined a custom namespace, <code>simmap</code>, to hold our variables. This allows us to provide a URL with more detailed descriptions of what each of these elements mean:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw">add_namespaces</span>(<span class="kw">c</span>(<span class="dt">simmap =</span> <span class="st">&quot;https://github.com/ropensci/RNeXML/tree/master/inst/simmap.md&quot;</span>))</code></pre></div>
<p>At that URL we have posted a simple description of each term.</p>
<p>Using this convention we can generate NeXML files containing <code>simmap</code> data, read those files into R, and convert them back into the <code>phytools</code> package format. These simple functions serve as further illustration of how <code>RNeXML</code> can be used to extend the NeXML standard. We illustrate their use briefly here, starting with loading a <code>nexml</code> object containing a <code>simmap</code> reconstruction into R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(simmap_ex)</code></pre></div>
<p>The <code>get_trees()</code> function can be used to return an <code>ape::phylo</code> tree as usual. <code>RNeXML</code> automatically detects the <code>simmap</code> reconstruction data and returns includes this in a <code>maps</code> element of the <code>ape::phylo</code> object, for use with other <code>phytools</code> functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phy &lt;-<span class="st"> </span><span class="kw">nexml_to_simmap</span>(simmap_ex)</code></pre></div>
<p>We can then use various functions from <code>phytools</code> designed for <code>simmap</code> objects <span class="citation">(Revell 2012)</span>, such as the plotting function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;phytools&quot;</span>)
<span class="kw">plotSimmap</span>(phy)</code></pre></div>
<pre><code>no colors provided. using the following legend:
       A        B        C 
 &quot;black&quot;    &quot;red&quot; &quot;green3&quot; </code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt="Stochastic character mapping on a phylogeny, as generated by the phytools package after parsing the simmap-extended NeXML." />
<p class="caption">Stochastic character mapping on a phylogeny, as generated by the phytools package after parsing the simmap-extended NeXML.</p>
</div>
<p>Likewise, we can convert the object back in the NeXML format and write it out to file to be read by other users.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nex &lt;-<span class="st"> </span><span class="kw">simmap_to_nexml</span>(phy) 
<span class="kw">nexml_write</span>(nex, <span class="st">&quot;simmap.xml&quot;</span>)</code></pre></div>
<pre><code>[1] &quot;simmap.xml&quot;</code></pre>
<p>Though other NeXML parsers (for instance, for Perl or Python) have not been written explicitly to express <code>simmap</code> data, those parsers will nonetheless be able to successfully parse this file and expose the <code>simmap</code> data to the user.</p>
<div id="refs" class="references">
<div id="ref-Bollback_2006">
<p>Bollback, JonathanP. 2006. <em>BMC Bioinformatics</em> 7 (1). Springer Science + Business Media: 88. doi:<a href="https://doi.org/10.1186/1471-2105-7-88">10.1186/1471-2105-7-88</a>.</p>
</div>
<div id="ref-Huelsenbeck_2003">
<p>Huelsenbeck, John P., Rasmus Nielsen, and Jonathan P. Bollback. 2003. “Stochastic Mapping of Morphological Characters.” <em>Systematic Biology</em> 52 (2). Oxford University Press (OUP): 131–58. doi:<a href="https://doi.org/10.1080/10635150390192780">10.1080/10635150390192780</a>.</p>
</div>
<div id="ref-Revell_2012">
<p>Revell, Liam J. 2012. “Phytools: An R Package for Phylogenetic Comparative Biology (and Other Things).” <em>Methods in Ecology and Evolution</em> 3: 217–23.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
